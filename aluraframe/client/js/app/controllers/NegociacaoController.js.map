{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordemAtual","_negociacoesView","NegociacoesView","_listaNegociacoes","Bind","ListaNegociacoes","_mensagemView","MensagemView","_mensagem","Mensagem","_service","NegociacaoService","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","msg","_limpaFormulario","apaga","esvazia","importa","coluna","inverteOrdem","ordena","a","b","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\r\n    constructor(){\r\n\r\n        let $ = document.querySelector.bind(document);\r\n        this._inputData = $(\"#data\");\r\n        this._inputQuantidade = $(\"#quantidade\");\r\n        this._inputValor = $(\"#valor\");\r\n        this._ordemAtual = '';\r\n\r\n        this._negociacoesView = new NegociacoesView($(\"#negociacoesView\"));\r\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(), this._negociacoesView, ['adiciona', 'esvazia', 'ordena', 'inverteOrdem']);\r\n        \r\n        this._mensagemView = new MensagemView($(\"#mensagemView\"));\r\n        this._mensagem = new Bind(new Mensagem(), this._mensagemView, ['texto']);\r\n\r\n        this._service = new NegociacaoService();\r\n\r\n        this._init();\r\n    }\r\n    \r\n    _init(){\r\n        \r\n        this._service\r\n            .lista()\r\n            .then(negociacoes => \r\n                negociacoes.forEach(negociacao =>\r\n                    this._listaNegociacoes.adiciona(negociacao)))\r\n            .catch(erro => this._mensagem.texto = erro);\r\n        \r\n        setInterval(() => {\r\n    \r\n            this.importaNegociacoes();\r\n        }, 3000);\r\n    }\r\n\r\n    adiciona(event){\r\n\r\n        event.preventDefault(event);\r\n\r\n        let negociacao = this._criaNegociacao();\r\n\r\n        this._service\r\n            .cadastra(negociacao)\r\n            .then(msg => {\r\n\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = msg;\r\n                this._limpaFormulario();\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n    apaga() {\r\n        \r\n        this._service\r\n            .apaga()\r\n            .then(msg => {\r\n                \r\n                this._listaNegociacoes.esvazia();\r\n                this._mensagem.texto = msg;\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n    importaNegociacoes(){\r\n\r\n        this._service.importa(this._listaNegociacoes.negociacoes)\r\n            .then(negociacoes => \r\n                negociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao)))\r\n            .catch(erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n    ordena(coluna) {\r\n\r\n        if(this._ordemAtual == coluna){\r\n            this._listaNegociacoes.inverteOrdem();\r\n        }else{\r\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n        }\r\n        this._ordemAtual = coluna;\r\n    }\r\n\r\n    _criaNegociacao() {\r\n\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value)\r\n        );\r\n    }\r\n\r\n    _limpaFormulario() {\r\n        this._inputData.value = \"\";\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n\r\n        this._inputData.focus();\r\n    }\r\n}"]}